<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ù†ØµØ© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ†</title>
<style>
:root {
  --primary: #0a58ca;
  --bg: #f4f6f8;
  --card: #ffffff;
  --text: #000;
  --assistant: #e9ecef;
  --input-bg: #f1f3f6;
  --border-color: #ccc;
}

body.dark {
  --bg: #121212;
  --card: #1e1e1e;
  --text: #fff;
  --assistant: #2a2a2a;
  --input-bg: #2b2b2b;
  --border-color: #444;
}

body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  height: 100vh;
  display: flex;
  flex-direction: column;
}

header {
  background: var(--primary);
  color: white;
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

header h1 {
  margin: 0;
  font-size: 22px;
}

.container {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.sidebar {
  width: 200px;
  background: var(--card);
  border-left: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  padding: 15px;
  gap: 10px;
}

.sidebar h3 {
  margin: 0 0 10px 0;
}

.sidebar select {
  padding: 6px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
}

.main-chat {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: var(--bg);
}

.messages {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
}

.messages::-webkit-scrollbar {
  width: 6px;
}
.messages::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 3px;
}

.bubble {
  max-width: 70%;
  padding: 12px 16px;
  margin-bottom: 12px;
  border-radius: 20px;
  line-height: 1.5;
  font-size: 14px;
  word-wrap: break-word;
  animation: fadeIn 0.3s ease;
}

.user {
  background: var(--primary);
  color: white;
  margin-left: auto;
  border-bottom-right-radius: 0;
}

.assistant {
  background: var(--assistant);
  margin-right: auto;
  border-bottom-left-radius: 0;
}

@keyframes fadeIn {
  from {opacity: 0; transform: translateY(5px);}
  to {opacity: 1; transform: translateY(0);}
}

.input-area {
  padding: 12px;
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 10px;
  background: var(--input-bg);
}

textarea {
  flex: 1;
  height: 60px;
  border-radius: 12px;
  border: 1px solid var(--border-color);
  padding: 10px;
  resize: none;
  background: var(--card);
  color: var(--text);
}

button {
  padding: 10px 15px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-weight: bold;
  transition: 0.2s;
}

button.send {
  background: var(--primary);
  color: white;
}
button.send:hover { background: #0841a8; }

button.ask-teacher {
  background: #ffc107;
  color: #333;
}
button.ask-teacher:hover { background: #e0a800; }

button.upload {
  background: #6c757d;
  color: white;
}
button.upload:hover { background: #5a6268; }

</style>
</head>

<body>
<header>
  <h1>ğŸ¤– Ù…Ù†ØµØ© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ†</h1>
  <button onclick="document.body.classList.toggle('dark')">ğŸŒ™ Dark Mode</button>
</header>

<div class="container">
  <div class="sidebar">
    <h3>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯</h3>
    <select id="assistantSelect">
      <option value="math_mohamed">Ù…Ø³ØªØ± Ù…Ø­Ù…Ø¯ â€“ Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
      <option value="math_ahmed">Ù…Ø³ØªØ± Ø£Ø­Ù…Ø¯ â€“ Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
    </select>
    <button class="ask-teacher" onclick="askTeacher()">ğŸ“© Ø§Ø³Ø£Ù„ Ù…Ø³ØªØ±</button>
    <label class="upload">
      ğŸ–¼ï¸ Ø±ÙØ¹ ØµÙˆØ±Ø©
      <input type="file" id="imageInput" accept="image/*" hidden>
    </label>
  </div>

  <div class="main-chat">
    <div class="messages" id="messages">
      <div class="bubble assistant">Ø£Ù‡Ù„Ù‹Ø§ ğŸ‘‹ Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ ÙˆØ§Ø³Ø£Ù„ Ø³Ø¤Ø§Ù„Ùƒ</div>
    </div>
    <div class="input-area">
      <textarea id="input" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..."></textarea>
      <button class="send" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>
</div>

<script>
async function sendMessage() {
  const input = document.getElementById("input");
  const assistant = document.getElementById("assistantSelect").value;
  const text = input.value.trim();
  if (!text) return;

  const messages = document.getElementById("messages");
  messages.innerHTML += `<div class="bubble user">${text}</div>`;
  input.value = "";
  messages.scrollTop = messages.scrollHeight;

  try {
    const res = await fetch("http://127.0.0.1:8000/chat", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({message: text, assistant: assistant})
    });
    const data = await res.json();
    messages.innerHTML += `<div class="bubble assistant"><b>${assistant}</b><br>${data.reply}</div>`;
    messages.scrollTop = messages.scrollHeight;
  } catch(e) {
    messages.innerHTML += `<div class="bubble assistant">âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…</div>`;
  }
}

function askTeacher() {
  const input = document.getElementById("input").value.trim();
  if (!input) { alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„"); return; }
  alert("ğŸ“© ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù„Ù…Ø³ØªØ± Ù…Ø­Ù…Ø¯");
}
</script>

</body>
</html>
